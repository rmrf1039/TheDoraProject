(function(l,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(l=typeof globalThis<"u"?globalThis:l||self,e(l.V3InfiniteLoading={},l.Vue))})(this,function(l,e){"use strict";const C="",u=(t,n)=>{const o=t.__vccOpts||t;for(const[r,i]of n)o[r]=i;return o},y={},h=t=>(e.pushScopeId("data-v-39432f99"),t=t(),e.popScopeId(),t),b={class:"container"},E=[h(()=>e.createElementVNode("div",{class:"spinner"},null,-1))];function S(t,n){return e.openBlock(),e.createElementBlock("div",b,E)}const x=u(y,[["render",S],["__scopeId","data-v-39432f99"]]),k=t=>({loading(){t.value="loading"},loaded(){t.value="loaded"},complete(){t.value="complete"},error(){t.value="error"}}),I=(t,n)=>()=>{n.loading(),t("infinite",n)},N=(t,n)=>{const o=t.getBoundingClientRect();if(!n)return o.top>=0&&o.bottom<=window.innerHeight;const r=n.getBoundingClientRect();return o.top>=r.top&&o.bottom<=r.bottom};let f;const _=t=>{t.parentEl=document.querySelector(t.target)||null;let n=`0px 0px ${t.distance}px 0px`;t.top&&(n=`${t.distance}px 0px 0px 0px`),f=new IntersectionObserver(o=>{o[0].isIntersecting&&(t.firstload&&t.emit(),t.firstload=!0)},{root:t.parentEl,rootMargin:n}),f.observe(t.infiniteLoading.value)},p=()=>{f.disconnect()},T="",V={class:"state-error"},B=u({__name:"InfiniteLoading",props:{top:{type:Boolean,required:!1},target:{type:[String,Boolean],required:!1},distance:{type:Number,required:!1,default:0},identifier:{required:!1},firstload:{type:Boolean,required:!1,default:!0},slots:{type:Object,required:!1}},emits:["infinite"],setup(t,{emit:n}){const o=t,r=e.ref(null),i=e.ref("ready"),{top:m,firstload:q,target:v,distance:w}=o,{identifier:g}=e.toRefs(o),s={infiniteLoading:r,target:v,top:m,firstload:q,distance:w,emit:I(n,k(i)),parentEl:null},L=()=>e.watch(i,async c=>{const a=s.parentEl||document.documentElement,d=a.scrollHeight;await e.nextTick(),c=="loaded"&&m&&(a.scrollTop=a.scrollHeight-d),c=="loaded"&&N(r.value,s.parentEl)&&s.emit(),c=="complete"&&p()}),O=()=>e.watch(g,()=>{i.value="ready",p(),_(s)});return e.onMounted(()=>{_(s),L(),g&&O()}),e.onUnmounted(()=>{p()}),(c,a)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"infiniteLoading",ref:r},[i.value=="loading"?e.renderSlot(c.$slots,"spinner",{key:0},()=>[e.createVNode(x)],!0):e.createCommentVNode("v-if",!0),i.value=="complete"?e.renderSlot(c.$slots,"complete",{key:1},()=>{var d;return[e.createElementVNode("span",null,e.toDisplayString(((d=t.slots)==null?void 0:d.complete)||"No more results!"),1)]},!0):e.createCommentVNode("v-if",!0),i.value=="error"?e.renderSlot(c.$slots,"error",{key:2,retry:s.emit},()=>{var d;return[e.createElementVNode("span",V,[e.createElementVNode("span",null,e.toDisplayString(((d=t.slots)==null?void 0:d.error)||"Oops something went wrong!"),1),e.createElementVNode("button",{class:"retry",onClick:a[0]||(a[0]=(...$)=>s.emit&&s.emit(...$))},"retry")])]},!0):e.createCommentVNode("v-if",!0)],512))}},[["__scopeId","data-v-231b1688"]]);l.default=B,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});